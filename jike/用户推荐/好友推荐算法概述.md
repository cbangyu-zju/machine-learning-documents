<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>
## 好友推荐算法概述

### 好友关系分类
在互联网社交中，好友关系主要有两种形态：

* 无向的好友关系，如微信/QQ/facebook/人人网等；
* 有向的关注关系，如微博/twitter/即刻等

### 好友推荐算法

* 二度好友：friend of friend
* 兴趣爱好/学校/专业/职业等相同的人
* 社交网络模型
* 社交网络与用户标签的结合
* 社区发现算法
* 分类模型


### 二度好友推荐：Friend of Friend 算法
Friend of friend(FOF)算法的基本思想：如果两个用户之间的共同好友数目越多，则代表他们认识的概率越大，要么是已经认识的要么是很快就通过共同好友认识。设用户\\(Vi\\)和\\(Vj\\)之间的相似度用\\(sim({V\_{i}, V\_{j}})\\)，则其计算公式为：
$$ sim({V\_{i}, V\_{j}}) = (V\_{i}) \bigcap (V\_{j})$$

该公式表示两个用户之间此外，还有一些FOF算法的变种，比如朋友数少的那些共同朋友比朋友数多的共同朋友的贡献值更大，因此可以根据朋友数赋予每个共同朋友一个权重值，最后采用加权平均的方式来计算相似度。
即：
$$ sim({V\_{i}, V\_{j}})' = \frac{sim({V\_{i}, V\_{j}})}{\sum_{i=1}^n  sim({V\_{i}})} $$

得到相似值之后，根据该相似值大小排序，取最大TopN的用户进行推荐。该算法再聚集系数较高的社交网络中表现非常好。

### 基于兴趣爱好/地点/机构/专业/职业等相同的推荐
在互联好友中，可以通过用户本身的兴趣爱好，或者他本身的固有特征进行推荐。比如，可以利用地点信息进行同城推荐，或者利用机构信息为用户进行线下关系的关联推荐，等等。

在这些固有特征中，基于发现线下关系的推荐相对比较简单，但是数据量少，这导致了该类推荐的覆盖就很低。因此，通过用户的兴趣爱好，来进行好友推荐可以弥补覆盖的问题。目前基于用户兴趣爱好的推荐算法主要是一些概率图模型算法，主要有LDA等潜语义模型。以下介绍一种基于兴趣爱好的好友推荐算法步骤：

1. 利用tf-idf算法抽取出所有文本中重要的词，作为文本的标签；
2. 根据用户对文本的行为特征，将文本的标签传递到用户身上；
3. 构建出用户文档：用m个不同标签来表示拥护；
4. 然后用LDA模型来求解得到：用户对不同话题的喜好特征；
5. 最后利用上述用户喜好特征，求得用户相似度，并进行好友推荐。

### 社交网络模型
用户之间的关系可以用社交网络来表示，用户可以表示为网络的顶点，用户之间的关系可以理解成顶点之间对应的边。社交网络能表示为一个图，如下所示：

 ![GitHub](http://www.corpwatch.org/sites/default/files/styles/large/public/SNA.jpg?itok=CEUvHpvF "GitHub,Social Coding")

在这种社交网络中，Facebook和QQ中的好友关系是对等的，则该类的社交关系图是无向图。而另外一种如微博，Twitter和即刻中的关注关系，即A关注了B，但B不一定关注A，这种社交网路图是有向的。另外在复杂网络中，为了描述两用户之间社交关系的强弱，边需要带上权重值。

在社交网络模型中，我们可以将好友发现问题转化为：1. 用户之间的距离问题，用户距离越近，那么他们相互认识的概率越大；2. 信任值预测问题，将好友关系转化为信任值，根据链路关系越长，信任值越弱。

### 距离问题的求解
在社交网络模型中，好友发现问题转化为距离问题求解时，某种可行算法是通过计算图中点与点之间的最短距离来选取出topN的好友推荐。问题的转化过程有以下几种办法

1. 在无权边的算法中，设社交网络中的边的权值皆为1，然后在这种图中，找出距离最短的用户； 

最短路径问题的求解算法有很多，可以是Floyd、Dijkstra、Bellman-Ford、SPFA等最优化算法。最短路径算法难点：

1. 算法复杂度问题；
2. 边带权重；

最短路径算法复杂度很高，facebook在这块做了很多优化，比如定义[四度分离假设：好友关系不会大于4度](https://arxiv.org/pdf/1111.4570.pdf)等。这方面的优化可以看一下，这篇[知乎提问](https://www.zhihu.com/question/20010259)

### 信任值求解模型
而在信任值求解算法中，其实在一定程度上是利用已有的用户之间信任值，然后求解出未知用户之间的信任值。这算法有很多中，主要有：1. 信任值传播算法；2. 矩阵分解算法。如下所示

#### 信任值传播算法
信任值的传播，是假设用户对好友有一定的信任值，那么对他的好友也会有一定的信任值，其基本思想如下：

1. 形成一个连接图并对图中的边赋权值；
2. 对图中权重进行归一化；
3. 通过网络，用户传播它们的排序值到它们的邻居，反复迭代直到矩阵收敛；
4. 最后根据每个用户最后的排序值进行topN排序。

信任值传播算法的基本实现是PersonalRank算法。PersonalRank算法和PageRank算法类似，用随机游走过程来求解的话，奇过程如下：

1. 形成一个连接图并对图中的边赋权值；
2. 对图中权重进行归一化；
3. 然后用[PersonalRank](https://blog.csdn.net/google19890102/article/details/51719947)的思想对矩阵进行转移和求解；
4. 最后根据每个用户最后的排序值进行topN排序。

#### 矩阵分解算法
这里的矩阵分解算法和协同过滤算法类似，即将矩阵R表示为U*V，可以用潜语义模型来求解。如ALS算法，其过程如下：

1. 先为U和V中的任意一个矩阵，给出一个随机的结果，并固定；// 假设先固定V
2. 然后，在用已知的R和V来求解该情况下最优的U，方法是[最小二乘法](https://zh.wikipedia.org/wiki/%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E6%B3%95)求解。
3. 得到上一步的U之后，将U作为已知，用R和U来求解V
4. 然后依次迭代，直到最小二乘法结果的E满足一定条件，或者迭代次数完成之后终止跌倒
5. 得到最终的U和V；

### 社交网络与用户标签的结合
在社交网络中，之前我们只用到了用户之间的关系，但是很多时候，在互联网社交网络中，人与人的认识都是因为大家之间具有相同的特征，这里可以由标签进行表示。如何合理的利用这些特征来对推荐效果进行优化，一个比较重要的问题，目前有很多人对这块做了很多尝试。如

[1] [A Unified Framework for Link Recommendation Using Random Walks](https://www3.nd.edu/~tweninge/pubs/YGWH_ASONAM10.pdf).

[2] [Friend recommendation with content spread enhancement in social networks](http://or.nsfc.gov.cn/bitstream/00001903-5/329724/1/1000014313947.pdf).


### 社区发现算法
可以看看这个[PPT](https://blog.csdn.net/itplus/article/details/9286905)

常用的算法主要有：

* SLPA，标签重播算法的拓展；
* infomap
* 等等